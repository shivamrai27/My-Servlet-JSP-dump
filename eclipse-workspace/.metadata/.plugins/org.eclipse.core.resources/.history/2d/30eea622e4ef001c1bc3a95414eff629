package com.DAO;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import com.entity.TodoDtls.*;
import com.mysql.cj.protocol.Resultset;

import java.sql.Connection;
import java.sql.PreparedStatement;

import com.entity.TodoDtls;

public class TodoDAO {
	private Connection conn;

	public TodoDAO(Connection conn) {
		super();
		this.conn = conn;
	}

	public boolean addTask(String task, String status) {

		boolean f = false;
		try {
			String query = "insert into tasks(task,status) values(?,?)";

			PreparedStatement ps = conn.prepareStatement(query);
			ps.setString(1, task);
			ps.setString(2, status);
			int i = ps.executeUpdate();
			if (i > 0) {
				f = true;
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
		return f;
	}

	public List<TodoDtls> getTodo() {
		List<TodoDtls> list = new ArrayList<TodoDtls>();
		TodoDtls l = null;
		try {
			String sql = "select * from tasks";
			PreparedStatement ps = conn.prepareStatement(sql);
			ResultSet rs = ps.executeQuery();
			while (rs.next()) {
				l = new TodoDtls();
				l.setId((rs.getInt(1)));
				l.setTask((rs.getString(2)));
				l.setStatus((rs.getString(3)));
				list.add(l);

			}
		} catch (Exception e) {
			e.printStackTrace();
		}
		return list;
	}
	
		public TodoDtls getTodoById(int id) {
			TodoDtls l = null;
			try {
				String sql = "select * from task where id =?";
				PreparedStatement ps = conn.prepareStatement(sql);
				ps.setInt(1, id );
				ResultSet rs = ps.executeQuery();
				while(rs.next()) {
					l = new TodoDtls();
					l.setId((rs.getInt(1)));
					l.setTask((rs.getString(2)));
					l.setStatus((rs.getString(3)));
					
				}
			} catch (Exception e) {
				e.printStackTrace();
			}
			return l;
		}
}
